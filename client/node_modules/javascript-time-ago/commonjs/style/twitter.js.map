{"version":3,"sources":["../../source/style/twitter.js"],"names":["formatters","gradation","canonical","threshold","day","hour","format","value","locale","this_year","Intl","DateTimeFormat","month","now","nextYear","Date","getFullYear","getTime","other","year","flavour"],"mappings":";;;;;;;AAAA;;AACA;;;;;;AAEA;AACA;AACA,IAAMA,UAAU,GAAG,EAAnB,C,CAEA;AACA;AACA;AACA;;eAEA;AACC;AACA;AACAC,EAAAA,SAAS,EAAE,CACV;AADU,oBAGN,wBAAQC,oBAAR,EAAmB,QAAnB,CAHM;AAITC,IAAAA,SAAS,EAAE;AAJF,MAMV;AACA,0BAAQD,oBAAR,EAAmB,MAAnB,CAPU,EAQV;AACA;AACA;AACCC,IAAAA,SAAS,EAAEC,iBAAM,MAAMC,eADxB;AAECC,IAAAA,MAFD,kBAEQC,KAFR,EAEeC,MAFf,EAEuB;AACrB;AACA;AACA;AACA;;AACA;AACA,UAAI,CAAC,0CAAL,EAAoC;AACnC;AACA;AACD;;;AACA,UAAI,CAACR,UAAU,CAACQ,MAAD,CAAf,EAAyB;AACxBR,QAAAA,UAAU,CAACQ,MAAD,CAAV,GAAqB,EAArB;AACA;AACD;;;AACA,UAAI,CAACR,UAAU,CAACQ,MAAD,CAAV,CAAmBC,SAAxB,EAAmC;AAClC;AACAT,QAAAA,UAAU,CAACQ,MAAD,CAAV,CAAmBC,SAAnB,GAA+B,IAAIC,IAAI,CAACC,cAAT,CAAwBH,MAAxB,EAAgC;AAC9DI,UAAAA,KAAK,EAAG,OADsD;AAE9DR,UAAAA,GAAG,EAAK;AAFsD,SAAhC,CAA/B;AAIA,OApBoB,CAqBrB;;;AACA,aAAOJ,UAAU,CAACQ,MAAD,CAAV,CAAmBC,SAAnB,CAA6BH,MAA7B,CAAoC,wBAAQC,KAAR,CAApC,CAAP;AACA;AAzBF,GAVU,EAqCV;AACA;AACA;AACCJ,IAAAA,SADD,qBACWU,GADX,EACgB;AACd;AACA,UAAMC,QAAQ,GAAG,IAAIC,IAAJ,CAAS,IAAIA,IAAJ,CAASF,GAAT,EAAcG,WAAd,KAA8B,CAAvC,EAA0C,CAA1C,CAAjB;AACA,aAAO,CAACF,QAAQ,CAACG,OAAT,KAAqBJ,GAAtB,IAA6B,IAApC;AACA,KALF;AAMCP,IAAAA,MAND,kBAMQC,KANR,EAMeC,MANf,EAMuB;AACrB;AACA;AACA;AACA;;AACA;AACA,UAAI,CAAC,0CAAL,EAAoC;AACnC;AACA;AACD;;;AACA,UAAI,CAACR,UAAU,CAACQ,MAAD,CAAf,EAAyB;AACxBR,QAAAA,UAAU,CAACQ,MAAD,CAAV,GAAqB,EAArB;AACA;AACD;;;AACA,UAAI,CAACR,UAAU,CAACQ,MAAD,CAAV,CAAmBU,KAAxB,EAA+B;AAC9B;AACAlB,QAAAA,UAAU,CAACQ,MAAD,CAAV,CAAmBU,KAAnB,GAA2B,IAAIR,IAAI,CAACC,cAAT,CAAwBH,MAAxB,EAAgC;AAC1DW,UAAAA,IAAI,EAAI,SADkD;AAE1DP,UAAAA,KAAK,EAAG,OAFkD;AAG1DR,UAAAA,GAAG,EAAK;AAHkD,SAAhC,CAA3B;AAKA,OArBoB,CAsBrB;;;AACA,aAAOJ,UAAU,CAACQ,MAAD,CAAV,CAAmBU,KAAnB,CAAyBZ,MAAzB,CAAgC,wBAAQC,KAAR,CAAhC,CAAP;AACA;AA9BF,GAvCU,CAHZ;AA4ECa,EAAAA,OAAO,EAAE,CACR,MADQ,EAER,YAFQ,EAGR,QAHQ,EAIR,OAJQ;AA5EV,C","sourcesContent":["import { canonical, day, hour, getStep, getDate } from '../gradation'\r\nimport { intlDateTimeFormatSupported } from '../locale'\r\n\r\n// A cache for `Intl.DateTimeFormat` twitter formatters\r\n// for various locales (is a global variable).\r\nconst formatters = {}\r\n\r\n// Twitter style relative time formatting.\r\n// (\"1m\", \"2h\", \"Mar 3\", \"Apr 4, 2012\").\r\n// Seconds, minutes and hours are shown relatively,\r\n// and other intervals can be shown using full date format.\r\nexport default\r\n{\r\n\t// Twitter gradation is derived from \"canonical\" gradation\r\n\t// adjusting its \"minute\" `threshold` to be 45.\r\n\tgradation: [\r\n\t\t// Minutes\r\n\t\t{\r\n\t\t\t...getStep(canonical, 'minute'),\r\n\t\t\tthreshold: 45\r\n\t\t},\r\n\t\t// Hours\r\n\t\tgetStep(canonical, 'hour'),\r\n\t\t// If `date` and `now` happened the same year,\r\n\t\t// then only output month and day.\r\n\t\t{\r\n\t\t\tthreshold: day - 0.5 * hour,\r\n\t\t\tformat(value, locale) {\r\n\t\t\t\t// Whether can use `Intl.DateTimeFormat`.\r\n\t\t\t\t// If `Intl` is not available,\r\n\t\t\t\t// or the locale is not supported,\r\n\t\t\t\t// then don't override the default labels.\r\n\t\t\t\t/* istanbul ignore if */\r\n\t\t\t\tif (!intlDateTimeFormatSupported()) {\r\n\t\t\t\t\treturn\r\n\t\t\t\t}\r\n\t\t\t\t/* istanbul ignore else */\r\n\t\t\t\tif (!formatters[locale]) {\r\n\t\t\t\t\tformatters[locale] = {}\r\n\t\t\t\t}\r\n\t\t\t\t/* istanbul ignore else */\r\n\t\t\t\tif (!formatters[locale].this_year) {\r\n\t\t\t\t\t// \"Apr 11\" (MMMd)\r\n\t\t\t\t\tformatters[locale].this_year = new Intl.DateTimeFormat(locale, {\r\n\t\t\t\t\t\tmonth : 'short',\r\n\t\t\t\t\t\tday   : 'numeric'\r\n\t\t\t\t\t})\r\n\t\t\t\t}\r\n\t\t\t\t// Output month and day.\r\n\t\t\t\treturn formatters[locale].this_year.format(getDate(value))\r\n\t\t\t}\r\n\t\t},\r\n\t\t// If `date` and `now` happened in defferent years,\r\n\t\t// then output day, month and year.\r\n\t\t{\r\n\t\t\tthreshold(now) {\r\n\t\t\t\t// Jan 1st of the next year.\r\n\t\t\t\tconst nextYear = new Date(new Date(now).getFullYear() + 1, 0)\r\n\t\t\t\treturn (nextYear.getTime() - now) / 1000\r\n\t\t\t},\r\n\t\t\tformat(value, locale) {\r\n\t\t\t\t// Whether can use `Intl.DateTimeFormat`.\r\n\t\t\t\t// If `Intl` is not available,\r\n\t\t\t\t// or the locale is not supported,\r\n\t\t\t\t// then don't override the default labels.\r\n\t\t\t\t/* istanbul ignore if */\r\n\t\t\t\tif (!intlDateTimeFormatSupported()) {\r\n\t\t\t\t\treturn\r\n\t\t\t\t}\r\n\t\t\t\t/* istanbul ignore if */\r\n\t\t\t\tif (!formatters[locale]) {\r\n\t\t\t\t\tformatters[locale] = {}\r\n\t\t\t\t}\r\n\t\t\t\t/* istanbul ignore else */\r\n\t\t\t\tif (!formatters[locale].other) {\r\n\t\t\t\t\t// \"Apr 11, 2017\" (yMMMd)\r\n\t\t\t\t\tformatters[locale].other = new Intl.DateTimeFormat(locale, {\r\n\t\t\t\t\t\tyear  : 'numeric',\r\n\t\t\t\t\t\tmonth : 'short',\r\n\t\t\t\t\t\tday   : 'numeric'\r\n\t\t\t\t\t})\r\n\t\t\t\t}\r\n\t\t\t\t// Output day, month and year.\r\n\t\t\t\treturn formatters[locale].other.format(getDate(value))\r\n\t\t\t}\r\n\t\t}\r\n\t],\r\n\r\n\tflavour: [\r\n\t\t'tiny',\r\n\t\t'short-time',\r\n\t\t'narrow',\r\n\t\t'short'\r\n\t]\r\n}\r\n"],"file":"twitter.js"}